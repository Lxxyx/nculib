webpackJsonp([2,0],[function(t,e,o){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}var i=o(1),a=s(i),n=o(3),l=s(n),d=o(14),u=s(d),r=o(13),c=s(r);o(9),a["default"].use(l["default"]),a["default"].use(u["default"]),new a["default"]({el:"body",components:{App:c["default"]}})},,function(t,e){},,function(t,e,o){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(5),a=s(i),n=o(1),l=s(n),d=o(3);l["default"].filter("title",function(t){return t.replace(";","")}),e["default"]={data:function(){return{stuId:"",isLogin:!1,operate:"",showOperate:!1,showAdd:!1,showDel:!1,showSave:!1,showMail:!1,user:{},books:[],addBook:""}},computed:{addBookState:function(){return this.addBook.length?10===this.addBook.length?"success":"error":""}},methods:{login:function(t){var e=this;this.$http.get("/api/users/"+this.stuId).then(function(t){return t.data}).then(function(t){e.user=t,e.isLogin=!0,e.booksInfo(t.books),d.Indicator.open("正在加载书籍情况中，请稍等")})["catch"](function(){(0,d.Toast)({message:"您的输入不合法，请重新输入！"})})},booksInfo:function(t){var e=this;this.user.books=t,this.$http.post("/api/lib",(0,a["default"])(t)).then(function(t){return t.data}).then(function(t){t.forEach(function(e,o){t[o].location="馆藏地址："+e.location}),e.books=t,e.showOperate=!0,d.Indicator.close()})},addSub:function(){this.showAdd=!0,this.showSave=!0,this.operate="add"},delSub:function(){this.showDel=!0,this.showSave=!0,this.operate="del"},delBook:function(t){this.books.splice(t,1),this.user.books.splice(t,1)},addMail:function(){this.showSave=!0,this.showMail=!0,this.operate="mail"},save:function(t){function e(t){t.$http.post("/api/users/"+t.stuId+"/books",(0,a["default"])(t.user.books)).then(function(t){return t.data}).then(function(){(0,d.Toast)({message:"保存成功"}),t.showDel=!1,t.showSave=!1,t.operate="",d.Indicator.close()})}function o(t){t.$http.post("/api/users/"+t.stuId+"/email",(0,a["default"])({email:t.user.email})).then(function(t){return t.data}).then(function(){(0,d.Toast)({message:"保存邮箱成功"}),t.showMail=!1,t.showSave=!1,t.operate="",d.Indicator.close()})}var s=this;"add"===this.operate?(d.Indicator.open("正在保存"),this.$http.post("/api/lib",(0,a["default"])([this.addBook])).then(function(t){return t.data}).then(function(t){t.includes("Error")?((0,d.Toast)({message:"书籍号有误，请检查重试"}),d.Indicator.close()):(s.user.books.push(s.addBook),e(s),s.showAdd=!1,s.books.push(t[0]),s.addBook="")})):"mail"===this.operate?(d.Indicator.open("正在保存"),o(this)):e(this)}}}},,,,function(t,e){},function(t,e){},function(t,e){},,function(t,e){t.exports='<div id=app> <mt-header title=图书馆订阅系统 style="font-size: 20px"></mt-header> <div class=login v-if=!isLogin> <mt-field label=学号 placeholder=请输入学号 type=text :value.sync=stuId></mt-field> <mt-button class=login-button size=large type=primary @click=login(this.value)> 登陆 </mt-button> </div> <div class=book-cell> <mt-cell v-for="ele in books" :title="ele.title | title" :label=ele.location> <span style="color: green" v-if=ele.canBorrowNum> 可借: {{ele.canBorrowNum}} </span> <span v-else=!ele.canBorrowNum> 可借: {{ele.canBorrowNum}} </span> <span class="mint-field-state is-error" v-if=showDel @click=delBook($index)> <i class="mintui mintui-field-error"></i> </span> </mt-cell> </div> <div class=book-add v-if=showAdd> <mt-field label=书籍号 placeholder="eg: 0000805778" :state=addBookState :value.sync=addBook> </mt-field> </div> <div class=set-mail v-if=showMail> <mt-field label=邮箱 placeholder=用于提醒你有书可借 type=text :value.sync=user.email> </mt-field> </div> <div class=operate v-if=showOperate> <mt-button type=primary size=normal v-if=!showSave @click=addSub>增加订阅</mt-button> <mt-button type=danger size=normal v-if=!showSave @click=delSub>删除订阅</mt-button> <mt-button style=width:91% type=primary plain v-if=!showSave @click=addMail> 设置邮箱 </mt-button> <mt-button style="background-color: #4CAF50; width:92%" type=primary v-if=showSave @click=save> 保存 </mt-button> </div> </div>'},function(t,e,o){var s,i;o(10),s=o(4),i=o(12),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports["default"]),i&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=i)}]);
//# sourceMappingURL=app.1bc64e9c438ff2f3be35.js.map